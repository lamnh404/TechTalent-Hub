<%- include('../partials/header', { title: 'My Applications' }) %>

    <body class="dashboard-page">
        <div class="dashboard-wrapper">

            <%- include('../partials/navbar', { activePage: 'applications' }) %>

                <main class="main-content">

                    <header class="dashboard-header">
                        <h5 class="mb-0 font-weight-bold text-dark">My Applications</h5>
                    </header>

                    <div class="p-4">

                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="card border-0 shadow-sm p-3 h-100">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">Total
                                                Applied</div>
                                            <div class="h3 mb-0 font-weight-bold text-dark">
                                                <%= applications ? applications.length : 0 %>
                                            </div>
                                        </div>
                                        <div class="bg-light p-3 rounded text-primary"><i
                                                class="fas fa-paper-plane fa-lg"></i></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-0 shadow-sm p-3 h-100">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">In
                                                Review</div>
                                            <div class="h3 mb-0 font-weight-bold text-dark">
                                                <%= applications ? applications.filter(a=> a.ApplicationStatus ===
                                                    'UnderReview' || a.ApplicationStatus === 'Interview').length : 0 %>
                                            </div>
                                        </div>
                                        <div class="bg-light p-3 rounded text-warning"><i
                                                class="fas fa-clock fa-lg"></i></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card border-0 shadow-sm rounded-lg overflow-hidden">
                            <div class="custom-table-wrapper">
                                <table class="table custom-table table-hover mb-0">
                                    <thead>
                                        <tr>
                                            <th class="pl-4 border-top-0">Company</th>
                                            <th class="border-top-0">Job Title</th>
                                            <th class="border-top-0">Applied Date</th>
                                            <th class="border-top-0">Status</th>
                                            <th class="text-right border-top-0 pr-4">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% if (applications && applications.length> 0) { %>
                                            <% applications.forEach(app=> { %>
                                                <tr>
                                                    <td class="pl-4 align-middle">
                                                        <div class="d-flex align-items-center">
                                                            <img src="<%= app.LogoURL || '/images/default-company.png' %>"
                                                                width="40" height="40"
                                                                class="rounded border mr-3 p-1 object-fit-contain bg-white">
                                                            <span class="font-weight-bold text-dark">
                                                                <%= app.CompanyName %>
                                                            </span>
                                                        </div>
                                                    </td>
                                                    <td class="align-middle">
                                                        <a href="/jobs/<%= app.JobID %>"
                                                            class="font-weight-bold text-dark text-decoration-none hover-primary">
                                                            <%= app.JobTitle %>
                                                        </a>
                                                        <br>
                                                        <small class="text-muted">
                                                            <%= app.Location %> â€¢ <%= app.EmploymentType %>
                                                        </small>
                                                    </td>
                                                    <td class="align-middle text-muted">
                                                        <%= new Date(app.ApplicationDate).toLocaleDateString() %>
                                                    </td>
                                                    <td class="align-middle">
                                                        <% let badgeClass='badge-soft-secondary text-secondary' ; if
                                                            (app.ApplicationStatus==='Submitted' )
                                                            badgeClass='badge-soft-info text-info' ; else if
                                                            (app.ApplicationStatus==='UnderReview' )
                                                            badgeClass='badge-soft-warning text-warning' ; else if
                                                            (app.ApplicationStatus==='Interview' )
                                                            badgeClass='badge-soft-primary text-primary' ; else if
                                                            (app.ApplicationStatus==='Offer' )
                                                            badgeClass='badge-soft-success text-success' ; else if
                                                            (app.ApplicationStatus==='Rejected' )
                                                            badgeClass='badge-soft-danger text-danger' ; %>
                                                            <span class="badge <%= badgeClass %> px-3 py-2">
                                                                <%= app.ApplicationStatus %>
                                                            </span>
                                                    </td>
                                                    <td class="text-right align-middle pr-4">
                                                        <a href="/jobs/<%= app.JobID %>"
                                                            class="btn btn-sm btn-outline-primary shadow-sm">
                                                            View Job
                                                        </a>
                                                    </td>
                                                </tr>
                                                <% }) %>
                                                    <% } else { %>
                                                        <tr>
                                                            <td colspan="5" class="text-center py-5">
                                                                <img src="/images/empty-state.svg" width="150"
                                                                    class="mb-3 opacity-50">
                                                                <p class="text-muted mb-0">You haven't applied to any
                                                                    jobs yet.</p>
                                                                <a href="/jobs"
                                                                    class="btn btn-primary btn-sm mt-3 px-4">Find
                                                                    Jobs</a>
                                                            </td>
                                                        </tr>
                                                        <% } %>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </main>
        </div>
        <%- include('../partials/footer') %>
    </body>
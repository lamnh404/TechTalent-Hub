<%- include('../partials/header') %>

    <body>
        <%- include('../partials/navbar') %>

            <div class="main-content" style="padding-top: 80px;">
                <div class="container">
                    <div class="row mb-4">
                        <div class="col-12">
                            <h2 class="font-weight-bold">My Applications</h2>
                            <p class="text-muted">Track the status of your job applications.</p>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12">
                            <% if (applications && applications.length> 0) { %>
                                <div class="card shadow-sm border-0">
                                    <div class="card-body p-0">
                                        <div class="table-responsive">
                                            <table class="table table-hover mb-0">
                                                <thead class="bg-light">
                                                    <tr>
                                                        <th class="border-top-0 pl-4">Company</th>
                                                        <th class="border-top-0">Job Title</th>
                                                        <th class="border-top-0">Applied Date</th>
                                                        <th class="border-top-0">Status</th>
                                                        <th class="border-top-0 text-right pr-4">Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% applications.forEach(app=> { %>
                                                        <tr>
                                                            <td class="pl-4 align-middle">
                                                                <div class="d-flex align-items-center">
                                                                    <% if (app.LogoURL) { %>
                                                                        <img src="<%= app.LogoURL %>"
                                                                            alt="<%= app.CompanyName %>"
                                                                            class="rounded mr-3"
                                                                            style="width: 40px; height: 40px; object-fit: contain;">
                                                                        <% } else { %>
                                                                            <div class="bg-light rounded mr-3 d-flex align-items-center justify-content-center text-secondary"
                                                                                style="width: 40px; height: 40px;">
                                                                                <i class="fas fa-building"></i>
                                                                            </div>
                                                                            <% } %>
                                                                                <span class="font-weight-bold">
                                                                                    <%= app.CompanyName %>
                                                                                </span>
                                                                </div>
                                                            </td>
                                                            <td class="align-middle">
                                                                <a href="/jobs/<%= app.JobID %>"
                                                                    class="text-dark font-weight-bold">
                                                                    <%= app.JobTitle %>
                                                                </a>
                                                                <br>
                                                                <small class="text-muted">
                                                                    <%= app.Location %> â€¢ <%= app.EmploymentType %>
                                                                </small>
                                                            </td>
                                                            <td class="align-middle">
                                                                <%= new Date(app.ApplicationDate).toLocaleDateString()
                                                                    %>
                                                            </td>
                                                            <td class="align-middle">
                                                                <% let badgeClass='badge-secondary' ; if
                                                                    (app.ApplicationStatus==='Submitted' )
                                                                    badgeClass='badge-info' ; else if
                                                                    (app.ApplicationStatus==='UnderReview' )
                                                                    badgeClass='badge-warning' ; else if
                                                                    (app.ApplicationStatus==='Interview' )
                                                                    badgeClass='badge-primary' ; else if
                                                                    (app.ApplicationStatus==='Offer' )
                                                                    badgeClass='badge-success' ; else if
                                                                    (app.ApplicationStatus==='Rejected' )
                                                                    badgeClass='badge-danger' ; %>
                                                                    <span class="badge <%= badgeClass %> px-3 py-2">
                                                                        <%= app.ApplicationStatus %>
                                                                    </span>
                                                            </td>
                                                            <td class="align-middle text-right pr-4">
                                                                <a href="/jobs/<%= app.JobID %>"
                                                                    class="btn btn-sm btn-outline-primary">View Job</a>
                                                            </td>
                                                        </tr>
                                                        <% }) %>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <% } else { %>
                                    <div class="text-center py-5">
                                        <img src="/images/empty-state.svg" alt="No Applications" class="mb-4"
                                            style="max-width: 200px; opacity: 0.5;">
                                        <h4>No applications yet</h4>
                                        <p class="text-muted mb-4">You haven't applied to any jobs yet. Start your
                                            search today!</p>
                                        <a href="/jobs" class="btn btn-primary px-4 rounded-pill">Find Jobs</a>
                                    </div>
                                    <% } %>
                        </div>
                    </div>
                </div>
            </div>

            <%- include('../partials/footer') %>

                <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
                <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
                <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    </body>

    </html>